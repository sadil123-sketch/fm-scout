# FM Genie Scout UI/UX Redesign
## User Flows Documentation

**Version:** 1.0  
**Date:** December 2025  
**Author:** Product Team  

---

## Table of Contents

1. [Overview](#overview)
2. [User Personas](#user-personas)
3. [Core User Flows](#core-user-flows)
   - [Flow 1: Application Launch & Game Loading](#flow-1-application-launch--game-loading)
   - [Flow 2: Player Search & Filtering](#flow-2-player-search--filtering)
   - [Flow 3: Staff Search & Filtering](#flow-3-staff-search--filtering)
   - [Flow 4: Club Search & Filtering](#flow-4-club-search--filtering)
   - [Flow 5: Player Profile Exploration](#flow-5-player-profile-exploration)
   - [Flow 6: Shortlist Management](#flow-6-shortlist-management)
   - [Flow 7: Player Comparison](#flow-7-player-comparison)
   - [Flow 8: Rating System Customization](#flow-8-rating-system-customization)
   - [Flow 9: History Points & Snapshots](#flow-9-history-points--snapshots)
   - [Flow 10: Data Export](#flow-10-data-export)
4. ["g" Edition Gated Flows](#g-edition-gated-flows)
   - [Flow 11: GS STATS Development Forecast](#flow-11-gs-stats-development-forecast)
   - [Flow 12: Role Finder](#flow-12-role-finder)
   - [Flow 13: Top Lists](#flow-13-top-lists)
   - [Flow 14: Probability of Development](#flow-14-probability-of-development)
   - [Flow 15: In-Game Scout (IGS)](#flow-15-in-game-scout-igs)
5. [Error States & Edge Cases](#error-states--edge-cases)
6. [State Management Considerations](#state-management-considerations)

---

## Overview

This document defines all user flows for the FM Genie Scout redesign. Each flow is mapped with:
- Entry points
- Decision nodes
- Success/failure states
- "g" Edition gates (where applicable)
- State transitions

**Design Principles Applied:**
- Progressive disclosure for complexity management
- Real-time feedback for filter operations
- Virtualized rendering for 250k+ records
- Consistent navigation patterns across entities

---

## User Personas

| Persona | Description | Primary Goals |
|---------|-------------|---------------|
| **New Player** | First-time FM companion tool user. Finds current interface intimidating. | Load save quickly, run simple searches, export shortlist with minimal config |
| **Experienced Scout** | Long-time user familiar with CA/PA ratings and advanced filters. | Customize ratings, build complex filters, compare players/staff, export for analysis |
| **"g" Edition User** | Paying user accessing predictive features (GS STATS, Role Finder, Top Lists). | Leverage projections and top-lists to optimize transfers and development |

---

## Core User Flows

### Flow 1: Application Launch & Game Loading

**Trigger:** User launches FM Genie Scout application

**Actors:** All personas

```mermaid
flowchart TD
    A[Launch Application] --> B{Previous Session Data?}
    B -->|Yes| C[Load Cached Preferences]
    B -->|No| D[Initialize Default State]
    
    C --> E[Display Dashboard]
    D --> E
    
    E --> F{FM Process Running?}
    F -->|Yes| G[Show 'Load Active Save' Card]
    F -->|No| H[Show 'FM Not Detected' Card]
    
    G --> I{User Clicks 'Load Save'}
    H --> J[Display Instructions + Manual Load Option]
    
    I --> K[Auto-Detect Save File]
    J --> L{User Selects Manual Load}
    
    K --> M{Save Found?}
    L --> N[Open File Picker]
    
    M -->|Yes| O[Display Progress Bar]
    M -->|No| N
    
    N --> P{Valid .fm File?}
    P -->|Yes| O
    P -->|No| Q[Show Error: Invalid File]
    Q --> N
    
    O --> R[Parse Players ~250k]
    R --> S[Parse Staff]
    S --> T[Parse Clubs]
    T --> U[Parse Shortlists]
    
    U --> V{Parse Complete?}
    V -->|Yes| W[Cache Directory Paths]
    V -->|Error| X[Show Error Dialog with Retry]
    
    W --> Y[Enable All Features]
    Y --> Z[Navigate to Last View or Dashboard]
    
    X --> E
```

**State Transitions:**

| State | Description | Data Required |
|-------|-------------|---------------|
| `IDLE` | App launched, no save loaded | None |
| `DETECTING` | Scanning for FM process | OS process list |
| `LOADING` | Parsing save file | File path, FM version |
| `READY` | Save loaded, features enabled | Full database in memory |
| `ERROR` | Load failed | Error type, message |

**Success Criteria:**
- Save loads in < 30 seconds for 250k records
- Progress bar shows meaningful status messages
- Directory paths persisted for next session
- Auto-sync shortlist from FM enabled by default

---

### Flow 2: Player Search & Filtering

**Trigger:** User wants to find players matching specific criteria

**Actors:** All personas (complexity varies)

```mermaid
flowchart TD
    A[Open Filter Panel] --> B[Display Unified Filter Panel]
    B --> C[Default to 'Players' Tab]
    
    C --> D{User Persona}
    D -->|New Player| E[Show Presets Prominently]
    D -->|Experienced| F[Show Last Used Filters]
    D -->|g Edition| G[Show Presets + Advanced Toggle]
    
    E --> H{Select Preset?}
    F --> I[Display Full Filter Categories]
    G --> I
    
    H -->|Wonderkids| J[Apply Preset: Age â‰¤21, PA â‰¥150]
    H -->|Top Bargains| K[Apply Preset: Value â‰¤5M, CA â‰¥130]
    H -->|Free Agents| L[Apply Preset: Contract = Free]
    H -->|Custom| I
    
    J --> M[Update Result Count in Real-Time]
    K --> M
    L --> M
    
    I --> N[General Filters Section]
    N --> N1[Position Multi-Select]
    N --> N2[Age Range Slider]
    N --> N3[Nationality Search/Select]
    N --> N4[Division Dropdown]
    
    N1 --> M
    N2 --> M
    N3 --> M
    N4 --> M
    
    I --> O[CA/PA & Rating Section]
    O --> O1[CA Range Slider]
    O --> O2[PA Range Slider]
    O --> O3[Rating Threshold]
    
    O1 --> M
    O2 --> M
    O3 --> M
    
    I --> P[Contract Section]
    P --> P1[Status Pills: Free/Expiring/Bosman]
    P --> P2[Value Range]
    P --> P3[Wage Range]
    P --> P4[Budget Helper Toggle]
    
    P1 --> M
    P2 --> M
    P3 --> M
    P4 --> M
    
    I --> Q[Attributes Section - Collapsible]
    Q --> Q1[Technical Grid 0-20]
    Q --> Q2[Mental Grid 0-20]
    Q --> Q3[Physical Grid 0-20]
    Q --> Q4[Hidden Attributes - Collapsed]
    Q --> Q5[Personality Profiles]
    Q --> Q6[Preferred Moves Multi-Select]
    
    Q1 --> M
    Q2 --> M
    Q3 --> M
    Q4 --> M
    Q5 --> M
    Q6 --> M
    
    subgraph g_edition [g Edition Only]
        R[Advanced Projection Toggle]
        R --> R1[Search by Potential Attributes]
        R1 --> M
    end
    
    G --> R
    
    M --> S{Results Count}
    S -->|0| T[Show 'No Results' + Suggestions]
    S -->|1-1000| U[Render Virtualized Table]
    S -->|1000+| V[Show Warning + Render First 1000]
    
    T --> W[Suggest Relaxing Filters]
    U --> X[Enable Sort/Column Customization]
    V --> X
    
    X --> Y{User Action}
    Y -->|Click Row| Z[Open Player Profile]
    Y -->|Save Filter| AA[Save to Favorites]
    Y -->|Clear All| AB[Reset with Undo Option]
    Y -->|Share| AC[Generate Shareable Link/Export]
    
    AA --> AD[Filter Added to Favorites Panel]
    AB --> A
    AC --> AE[Copy Link / Download Config]
```

**Filter Categories Structure:**

```
Players Filter Panel
â”œâ”€â”€ Presets (Quick Access)
â”‚   â”œâ”€â”€ Wonderkids
â”‚   â”œâ”€â”€ Top Bargains  
â”‚   â”œâ”€â”€ Free Agents
â”‚   â””â”€â”€ Custom Saved Filters
â”œâ”€â”€ General
â”‚   â”œâ”€â”€ Position (Multi-select chips)
â”‚   â”œâ”€â”€ Age (Dual-handle slider)
â”‚   â”œâ”€â”€ Nationality (Searchable dropdown)
â”‚   â””â”€â”€ Division (Hierarchical dropdown)
â”œâ”€â”€ CA/PA & Rating
â”‚   â”œâ”€â”€ Current Ability (Slider 1-200)
â”‚   â”œâ”€â”€ Potential Ability (Slider 1-200)
â”‚   â””â”€â”€ Minimum Rating % (Slider 0-100)
â”œâ”€â”€ Contract
â”‚   â”œâ”€â”€ Status (Pill buttons)
â”‚   â”œâ”€â”€ Market Value (Range input)
â”‚   â”œâ”€â”€ Sale Value (Range input)
â”‚   â”œâ”€â”€ Wages (Range input)
â”‚   â””â”€â”€ Budget Helper (Toggle + input)
â”œâ”€â”€ Attributes (Collapsible)
â”‚   â”œâ”€â”€ Technical (Grid of sliders)
â”‚   â”œâ”€â”€ Mental (Grid of sliders)
â”‚   â”œâ”€â”€ Physical (Grid of sliders)
â”‚   â”œâ”€â”€ Hidden (Collapsed by default)
â”‚   â”œâ”€â”€ Personality (Radio buttons)
â”‚   â””â”€â”€ Preferred Moves (Searchable multi-select)
â””â”€â”€ [g Edition] Advanced Projection
    â””â”€â”€ Search by Peak Attributes (Toggle)
```

**Real-Time Count Update Logic:**
- Debounce filter changes (300ms)
- Run count query on virtualized index
- Display count next to each active filter
- Total count in results header

---

### Flow 3: Staff Search & Filtering

**Trigger:** User wants to find staff (coaches, scouts, physios)

**Actors:** All personas

```mermaid
flowchart TD
    A[Open Filter Panel] --> B[Select 'Staff' Tab]
    
    B --> C{Select Role Preset?}
    C -->|Head of Youth Dev| D[Apply: Youth + High JPA/JPP]
    C -->|Assistant Manager| E[Apply: Tactical + Man Management]
    C -->|Scout| F[Apply: JPA + JPP + Adaptability]
    C -->|Physio| G[Apply: Physiotherapy + Sports Science]
    C -->|Coach| H[Show Coaching Category Filters]
    C -->|Custom| I[Show All Filters]
    
    D --> J[Update Results Real-Time]
    E --> J
    F --> J
    G --> J
    H --> J
    I --> J
    
    I --> K[General Filters]
    K --> K1[Age Range]
    K --> K2[Name Search]
    K --> K3[Nationality]
    K --> K4[Contract Status]
    
    I --> L[Training Ratings]
    L --> L1[Star Rating Sliders by Category]
    L --> L2[Attacking â˜…â˜…â˜…â˜…â˜…]
    L --> L3[Defending â˜…â˜…â˜…â˜…â˜…]
    L --> L4[Tactical â˜…â˜…â˜…â˜…â˜…]
    L --> L5[Technical â˜…â˜…â˜…â˜…â˜…]
    L --> L6[Mental â˜…â˜…â˜…â˜…â˜…]
    L --> L7[Fitness â˜…â˜…â˜…â˜…â˜…]
    L --> L8[Goalkeeping â˜…â˜…â˜…â˜…â˜…]
    
    I --> M[CA/PA Range]
    M --> M1[Current Ability Slider]
    M --> M2[Potential Ability Slider]
    
    I --> N[Hidden Attributes]
    N --> N1[Judging Player Ability]
    N --> N2[Judging Player Potential]
    N --> N3[Level of Discipline]
    N --> N4[Motivating]
    N --> N5[Man Management]
    
    J --> O{Results Count}
    O -->|Has Results| P[Render Staff Cards View]
    O -->|No Results| Q[Show Suggestions]
    
    P --> R{User Action}
    R -->|Click Card| S[Open Staff Profile]
    R -->|Compare| T[Select Multiple for Comparison]
    R -->|Add to Consideration| U[Add to Staff Shortlist]
```

**Staff Filter Structure:**

```
Staff Filter Panel
â”œâ”€â”€ Role Presets
â”‚   â”œâ”€â”€ Head of Youth Development
â”‚   â”œâ”€â”€ Assistant Manager
â”‚   â”œâ”€â”€ Scout
â”‚   â”œâ”€â”€ Physio
â”‚   â””â”€â”€ Coach (by specialty)
â”œâ”€â”€ General
â”‚   â”œâ”€â”€ Age Range
â”‚   â”œâ”€â”€ Name Search
â”‚   â”œâ”€â”€ Nationality
â”‚   â””â”€â”€ Contract Status
â”œâ”€â”€ Training Ratings (Star Sliders)
â”‚   â”œâ”€â”€ Attacking (0-5 stars)
â”‚   â”œâ”€â”€ Defending (0-5 stars)
â”‚   â”œâ”€â”€ Tactical (0-5 stars)
â”‚   â”œâ”€â”€ Technical (0-5 stars)
â”‚   â”œâ”€â”€ Mental (0-5 stars)
â”‚   â”œâ”€â”€ Fitness (0-5 stars)
â”‚   â””â”€â”€ Goalkeeping (0-5 stars)
â”œâ”€â”€ CA/PA
â”‚   â”œâ”€â”€ Current Ability
â”‚   â””â”€â”€ Potential Ability
â””â”€â”€ Hidden Attributes
    â”œâ”€â”€ Judging Player Ability
    â”œâ”€â”€ Judging Player Potential
    â”œâ”€â”€ Level of Discipline
    â”œâ”€â”€ Motivating
    â””â”€â”€ Man Management
```

---

### Flow 4: Club Search & Filtering

**Trigger:** User wants to explore clubs (transfers, vacancies, facilities)

**Actors:** All personas

```mermaid
flowchart TD
    A[Open Filter Panel] --> B[Select 'Clubs' Tab]
    
    B --> C[Display Club Filters]
    
    C --> D[Location Filters]
    D --> D1[Continent Dropdown]
    D --> D2[Country Multi-Select]
    D --> D3[League/Division Dropdown]
    
    C --> E[Reputation & Status]
    E --> E1[Reputation Range Slider]
    E --> E2[Manager Vacancy Toggle]
    E --> E3[Board Confidence Filter]
    
    C --> F[Finances]
    F --> F1[Transfer Budget Range]
    F --> F2[Wage Budget Range]
    F --> F3[Balance Range]
    
    C --> G[Facilities]
    G --> G1[Training Facility Rating]
    G --> G2[Youth Facility Rating]
    G --> G3[Stadium Capacity Range]
    
    C --> H[Tactical Fit]
    H --> H1[Formation Selector]
    H --> H2[Playing Style Tags]
    
    D1 --> I[Update Results]
    D2 --> I
    D3 --> I
    E1 --> I
    E2 --> I
    E3 --> I
    F1 --> I
    F2 --> I
    F3 --> I
    G1 --> I
    G2 --> I
    G3 --> I
    H1 --> I
    H2 --> I
    
    I --> J[Render Club Cards]
    
    J --> K{User Action}
    K -->|Click Club| L[Open Club Profile]
    K -->|View Players| M[Jump to Players Filter - Preset Club]
    K -->|View Staff| N[Jump to Staff Filter - Preset Club]
    K -->|Compare Clubs| O[Multi-Select Comparison View]
```

**Cross-Entity Linking:**

When viewing a club, users can:
1. **Jump to Players:** Pre-filter player search by club
2. **Jump to Staff:** Pre-filter staff search by club
3. **View Top XI:** Auto-generate best lineup

---

### Flow 5: Player Profile Exploration

**Trigger:** User clicks on a player from search results or shortlist

**Actors:** All personas

```mermaid
flowchart TD
    A[Click Player Row/Card] --> B[Open Player Profile Modal/Page]
    
    B --> C[Load Profile Header]
    C --> C1[Portrait from FM Graphics]
    C --> C2[Name, Age, Nationality Flag]
    C --> C3[Club Logo + Position Badge]
    C --> C4[Status Badges: Injured/Listed/etc]
    
    B --> D[Tab Navigation]
    
    D --> E[Profile Tab - Default]
    E --> E1[Radar Chart: Position Attributes]
    E --> E2[CA/PA Progress Bars]
    E --> E3[Hidden Attributes Table]
    E --> E4[Personality Traits with Tooltips]
    
    D --> F[Transfer Tab]
    F --> F1[Finance Card: Wage/Value/Clauses]
    F --> F2[Contract Expiry Countdown]
    F --> F3{g Edition?}
    F3 -->|Yes| F4[GS STATS: Comparable Transfer Fees]
    F3 -->|No| F5[Basic Transfer Info Only]
    
    D --> G[Positions Tab]
    G --> G1[Interactive Pitch Heatmap]
    G --> G2[Position Ratings 0-20]
    G --> G3[Footedness Indicator L/R]
    G --> G4[Preferred Moves List]
    
    D --> H[Ratings Tab]
    H --> H1[Role/Position Analyzer]
    H --> H2[Sortable Role Suitability List]
    H --> H3[Ideal Role Recommendation]
    H --> H4[Custom Rating Scheme Selector]
    
    D --> I[Report Tab - Genie's Report]
    I --> I1[Rich Narrative Summary]
    I --> I2[Strengths with Icons]
    I --> I3[Weaknesses with Warnings]
    I --> I4[Comparison Player Selector]
    I --> I5[Export Report Button]
    
    D --> J[History Tab]
    J --> J1{History Points Exist?}
    J1 -->|Yes| J2[Interactive Timeline Chart]
    J1 -->|No| J3[Prompt to Create First Snapshot]
    J2 --> J4[Attribute Progression Filters]
    J3 --> J5[Create History Point Button]
    
    subgraph g_edition [g Edition Only]
        K[Development Tab]
        K --> K1[GS STATS Skill Projections]
        K --> K2[Year-by-Year Line Graphs]
        K --> K3[Peak Age Prediction]
        K --> K4[Ideal Sale Time Annotation]
        
        L[Probability Section]
        L --> L1[Development Probability Bar]
        L --> L2[Progress Rate Gauge]
    end
    
    D --> K
    D --> L
    
    B --> M[Action Bar - Persistent]
    M --> M1[Add to Shortlist Button]
    M --> M2[Compare With Button]
    M --> M3[Create History Point]
    M --> M4[Share/Export Profile]
    
    M1 --> N[Shortlist Selector Dropdown]
    N --> N1[Select Existing Shortlist]
    N --> N2[Create New Shortlist]
    N1 --> O[Toast: Added to Shortlist]
    N2 --> P[New Shortlist Dialog]
    
    M2 --> Q[Open Comparison Mode]
    Q --> Q1[Search Second Player]
    Q1 --> R[Side-by-Side View]
```

**Profile Tab Data Structure:**

```typescript
interface PlayerProfile {
  // Header
  id: string;
  name: string;
  age: number;
  nationality: string[];
  club: Club;
  position: Position[];
  status: PlayerStatus[];
  portraitPath?: string;
  
  // Attributes
  technical: Record<TechnicalAttribute, number>;
  mental: Record<MentalAttribute, number>;
  physical: Record<PhysicalAttribute, number>;
  hidden: Record<HiddenAttribute, number>;
  
  // Abilities
  currentAbility: number;
  potentialAbility: number;
  
  // Contract
  wage: number;
  marketValue: number;
  saleValue: number;
  releaseClauses: ReleaseClause[];
  contractExpiry: Date;
  
  // Positions
  positionRatings: Record<Position, number>;
  preferredFoot: 'Left' | 'Right' | 'Either';
  weakFootAbility: number;
  preferredMoves: string[];
  
  // g Edition
  gsStats?: {
    projectedAttributes: ProjectedAttribute[];
    peakAge: number;
    developmentProbability: number;
    progressRate: 'Slow' | 'Normal' | 'Fast';
    idealSaleWindow: DateRange;
  };
  
  // History
  historyPoints: HistoryPoint[];
}
```

---

### Flow 6: Shortlist Management

**Trigger:** User wants to organize scouted players

**Actors:** All personas

```mermaid
flowchart TD
    A[Open Shortlists Panel] --> B{Shortlists Exist?}
    
    B -->|Yes| C[Display Shortlist List]
    B -->|No| D[Show Empty State + Create Button]
    
    C --> E[Show Active FM Shortlist - Auto-Synced]
    C --> F[Show Custom Shortlists]
    
    E --> G[Sync Status Indicator]
    G --> G1[Last Synced Timestamp]
    G --> G2[Auto-Sync Toggle]
    
    F --> H{User Action}
    H -->|Create New| I[New Shortlist Dialog]
    H -->|Import| J[File Picker: .xml/.txt]
    H -->|Select Shortlist| K[Display Players in Shortlist]
    
    I --> I1[Enter Name]
    I --> I2[Select Color Tag]
    I --> I3[Create Button]
    I3 --> L[New Shortlist Created]
    
    J --> J1{Valid File?}
    J1 -->|Yes| J2[Parse and Import]
    J1 -->|No| J3[Show Error]
    J2 --> M[Merge Dialog: Replace or Add]
    
    K --> N[Shortlist Player Table]
    N --> N1[Sortable Columns]
    N --> N2[Inline Annotations]
    N --> N3[Color Tags per Player]
    
    N --> O{Player Action}
    O -->|Add Note| P[Open Note Editor]
    O -->|Change Tag| Q[Tag Selector: Target/Watchlist/Loan/etc]
    O -->|Remove| R[Confirm Remove Dialog]
    O -->|Move to Another| S[Shortlist Selector]
    
    K --> T[Shortlist Actions]
    T --> T1[Export Shortlist]
    T --> T2[Share Shortlist]
    T --> T3[Merge with Another]
    T --> T4[Delete Shortlist]
    
    T1 --> U[Export Dialog]
    U --> U1[Format: HTML/Excel/CSV/TXT]
    U --> U2[Column Selection]
    U --> U3[Preview Pane]
    U --> U4[Export Button]
    
    T3 --> V[Select Source Shortlist]
    V --> W[Merge Options: Union/Intersection]
    W --> X[Preview Merged List]
    X --> Y[Confirm Merge]
```

**Annotation System:**

| Tag Color | Label | Use Case |
|-----------|-------|----------|
| ðŸŸ¢ Green | Target | Primary transfer target |
| ðŸŸ¡ Yellow | Watchlist | Monitor for future |
| ðŸ”µ Blue | Loan | Loan candidate |
| ðŸŸ  Orange | Academy | Youth prospect |
| ðŸ”´ Red | Avoid | Flagged issues |
| âšª Gray | Archived | No longer relevant |

---

### Flow 7: Player Comparison

**Trigger:** User wants to compare two or more players

**Actors:** All personas

```mermaid
flowchart TD
    A{Entry Point} --> B[From Player Profile]
    A --> C[From Search Results Multi-Select]
    A --> D[From Shortlist Multi-Select]
    
    B --> E[Click 'Compare With']
    E --> F[Search/Select Second Player]
    
    C --> G[Select 2+ Players with Checkbox]
    G --> H[Click 'Compare Selected']
    
    D --> I[Select 2+ Players with Checkbox]
    I --> J[Click 'Compare Selected']
    
    F --> K[Open Comparison View]
    H --> K
    J --> K
    
    K --> L[Side-by-Side Layout]
    L --> L1[Player Headers with Portraits]
    L --> L2[Radar Chart Overlay]
    L --> L3[Attribute Table with Diff Highlighting]
    L --> L4[Role Suitability Comparison]
    
    L3 --> M[Color Coding]
    M --> M1[Green: Player A Better]
    M --> M2[Red: Player A Worse]
    M --> M3[Yellow: Equal/Marginal]
    
    K --> N{g Edition?}
    N -->|Yes| O[Show Development Comparison]
    O --> O1[Projected Attributes Side-by-Side]
    O --> O2[Peak Age Comparison]
    O --> O3[Value Trajectory Graph]
    
    N -->|No| P[Basic Comparison Only]
    
    K --> Q[Actions]
    Q --> Q1[Add Another Player - Max 4]
    Q --> Q2[Remove Player]
    Q --> Q3[Export Comparison]
    Q --> Q4[Save Comparison to Notes]
    
    Q1 --> R{Max Players?}
    R -->|< 4| S[Search/Add Player]
    R -->|= 4| T[Show Max Reached Warning]
    
    S --> K
```

---

### Flow 8: Rating System Customization

**Trigger:** User wants to create custom player rating weights

**Actors:** Experienced Scout, "g" Edition User

```mermaid
flowchart TD
    A[Open Rating Designer] --> B{Existing Custom Ratings?}
    
    B -->|Yes| C[Show Rating Scheme List]
    B -->|No| D[Show Default Schemes + Create Button]
    
    C --> E{User Action}
    E -->|Edit Existing| F[Load Scheme into Editor]
    E -->|Create New| G[Start from Blank or Template]
    E -->|Delete| H[Confirm Delete Dialog]
    
    D --> I[Standard Presets Grid]
    I --> I1[Attacking Full-Back]
    I --> I2[Ball-Playing Defender]
    I --> I3[Box-to-Box Midfielder]
    I --> I4[Target Man]
    I --> I5[Inside Forward]
    I --> I6[etc...]
    
    I --> J[Use as Template Button]
    J --> G
    
    G --> K[Rating Editor Interface]
    K --> L[Position Selector]
    L --> L1[Select Primary Position]
    L --> L2[Select Role/Duty]
    
    K --> M[Attribute Weight Sliders]
    M --> M1[Technical Attributes Section]
    M --> M2[Mental Attributes Section]
    M --> M3[Physical Attributes Section]
    
    M1 --> N[Each Attribute: 0-100% Weight Slider]
    M2 --> N
    M3 --> N
    
    K --> O[Live Preview Panel]
    O --> O1[Sample Players from Database]
    O --> O2[Rating Recalculates in Real-Time]
    O --> O3[Before/After Comparison]
    
    K --> P[Tooltips & Help]
    P --> P1[Explain Each Attribute Impact]
    P --> P2[Warning: Different Leagues May Need Different Weights]
    
    K --> Q[Actions]
    Q --> Q1[Save Scheme]
    Q --> Q2[Save As New]
    Q --> Q3[Reset to Default]
    Q --> Q4[Export Scheme]
    Q --> Q5[Import Scheme]
    
    Q1 --> R[Name Scheme Dialog]
    R --> S[Scheme Saved Confirmation]
    
    S --> T[Scheme Available in Filters and Profiles]
```

---

### Flow 9: History Points & Snapshots

**Trigger:** User wants to track player development over time

**Actors:** All personas

```mermaid
flowchart TD
    A{Entry Point} --> B[From Player Profile History Tab]
    A --> C[From Global History Manager]
    
    B --> D{History Points Exist?}
    D -->|Yes| E[Display Timeline Chart]
    D -->|No| F[Empty State: Create First Snapshot]
    
    E --> G[Interactive Timeline]
    G --> G1[Hover: Show Exact Values]
    G --> G2[Click Point: Show Full Snapshot]
    G --> G3[Filter by Attribute Groups]
    G --> G4[Zoom In/Out Timeline]
    
    E --> H[Snapshot Actions]
    H --> H1[Create New Snapshot]
    H --> H2[Rename Snapshot]
    H --> H3[Delete Snapshot]
    H --> H4[Compare Two Snapshots]
    
    F --> I[Create History Point Button]
    I --> J[Capture Current Attributes]
    J --> K[Name Snapshot - Default: Date]
    K --> L[Snapshot Saved]
    L --> E
    
    C --> M[Global History Manager]
    M --> M1[List All Players with Snapshots]
    M --> M2[Filter by Date Range]
    M --> M3[Bulk Actions]
    
    M --> N[Auto-Snapshot Settings]
    N --> N1[Enable/Disable Auto-Snapshot]
    N --> N2[Interval: Monthly/Quarterly/Bi-Annually]
    N --> N3[Performance Warning Display]
    N --> N4[Player Selection: All/Shortlist Only]
    
    N3 --> O[Warning: Auto-snapshots Impact Performance]
    O --> O1[Estimated Storage Impact]
    O --> O2[Recommended Settings for DB Size]
```

---

### Flow 10: Data Export

**Trigger:** User wants to export data for external analysis

**Actors:** All personas

```mermaid
flowchart TD
    A{Export Source} --> B[From Search Results]
    A --> C[From Shortlist]
    A --> D[From Player Profile]
    A --> E[From Comparison View]
    
    B --> F[Export Dialog]
    C --> F
    D --> F
    E --> F
    
    F --> G[Format Selection]
    G --> G1[HTML - Styled Report]
    G --> G2[Excel - .xlsx with Formatting]
    G --> G3[CSV - Raw Data]
    G --> G4[TXT - Plain Text]
    
    F --> H[Column Selection]
    H --> H1[Preset: Basic Info]
    H --> H2[Preset: Full Attributes]
    H --> H3[Preset: Contract Details]
    H --> H4[Custom: Drag-Drop Column Picker]
    
    F --> I[Preview Pane]
    I --> I1[Show First 10 Rows]
    I --> I2[Update Live with Selections]
    
    F --> J[Export Options]
    J --> J1[Include Headers: Yes/No]
    J --> J2[Date Format Selection]
    J --> J3[Number Format: Decimal/Comma]
    
    F --> K[Export Button]
    K --> L[Generate File]
    L --> M[Save Dialog / Download]
    M --> N[Remember Last Export Location]
```

---

## "g" Edition Gated Flows

All flows in this section require active "g" Edition subscription. Non-subscribers see upgrade prompts.

### Flow 11: GS STATS Development Forecast

**Trigger:** User views player development predictions

**Gate:** "g" Edition subscription required

```mermaid
flowchart TD
    A[Open Player Profile] --> B{g Edition Active?}
    
    B -->|No| C[Show Upgrade Banner]
    C --> C1[Feature Preview Screenshot]
    C --> C2[Upgrade Button]
    C --> C3[Dismiss Option]
    
    B -->|Yes| D[Show Development Tab]
    
    D --> E[GS STATS Data Load]
    E --> E1{Data Available?}
    
    E1 -->|No| F[Insufficient Data Message]
    F --> F1[Explain: Requires Community Save Data]
    F --> F2[Opt-In to Contribute Toggle]
    
    E1 -->|Yes| G[Display Development Forecast]
    
    G --> H[Skill Projection Graphs]
    H --> H1[Line Chart: Attribute over Time]
    H --> H2[Multiple Attributes Overlay Option]
    H --> H3[Confidence Interval Shading]
    
    G --> I[Key Milestones]
    I --> I1[Expected Peak Age: X]
    I --> I2[Projected Peak CA: Y]
    I --> I3[Key Skill Increases Annotated]
    I --> I4[Decline Warning Points]
    
    G --> J[Transfer Value Projection]
    J --> J1[Value over Time Graph]
    J --> J2[Ideal Sale Window Highlighted]
    J --> J3[Comparable Players Reference]
    
    G --> K[Development Factors]
    K --> K1[Ambition Impact]
    K --> K2[Professionalism Impact]
    K --> K3[Determination Impact]
    K --> K4[Training Facility Effect]
    
    G --> L[Actions]
    L --> L1[Export Forecast Report]
    L --> L2[Add to Development Watchlist]
    L --> L3[Set Alert: Notify at Peak]
```

---

### Flow 12: Role Finder

**Trigger:** User wants to find players for specific tactical roles

**Gate:** "g" Edition subscription required

```mermaid
flowchart TD
    A[Open Role Finder] --> B{g Edition Active?}
    
    B -->|No| C[Show Upgrade Prompt]
    
    B -->|Yes| D[Role Finder Interface]
    
    D --> E[Tactic Selection]
    E --> E1[Formation Dropdown: 4-3-3, 4-4-2, etc]
    E --> E2[Visual Formation Display]
    E --> E3[Click Position on Pitch]
    
    E3 --> F[Role Selection for Position]
    F --> F1[Available Roles List: 100+]
    F --> F2[Role Description Tooltip]
    F --> F3[Key Attributes for Role]
    
    F --> G[Search Players for Role]
    G --> G1[Role Suitability Score Calculated]
    G --> G2[Results Sorted by Suitability]
    G --> G3[Group by Suitability Tier]
    
    G3 --> H[Suitability Tiers]
    H --> H1[Accomplished: 90%+]
    H --> H2[Competent: 70-89%]
    H --> H3[Unconvincing: 50-69%]
    H --> H4[Unsuitable: <50%]
    
    G --> I[Additional Filters]
    I --> I1[Age Range]
    I --> I2[Value Range]
    I --> I3[Availability: Free/Listed]
    I --> I4[Already in Squad Toggle]
    
    D --> J[Squad Gap Analysis]
    J --> J1[Import Current Squad]
    J --> J2[Highlight Weak Positions]
    J --> J3[Suggest Roles Lacking Depth]
    
    G --> K[Actions]
    K --> K1[Add to Shortlist]
    K --> K2[Compare Candidates]
    K --> K3[Export Role Search Results]
```

---

### Flow 13: Top Lists

**Trigger:** User wants to browse curated best player lists

**Gate:** "g" Edition subscription required

```mermaid
flowchart TD
    A[Open Top Lists] --> B{g Edition Active?}
    
    B -->|No| C[Show Limited Preview + Upgrade]
    C --> C1[Show Top 5 Only]
    C --> C2[Blur Remaining Results]
    C --> C3[Upgrade to Unlock Full Lists]
    
    B -->|Yes| D[Full Top Lists Interface]
    
    D --> E[List Type Tabs]
    E --> E1[Top Players - By Position]
    E --> E2[Most Promising - Wonderkids]
    E --> E3[Top Bargains - Value Picks]
    
    E1 --> F[Position Filter]
    F --> F1[GK / DF / MF / FW Toggle]
    F --> F2[Specific Position Dropdown]
    
    E2 --> G[Age Filter]
    G --> G1[U-18 / U-21 / U-23 Toggle]
    
    E3 --> H[Budget Filter]
    H --> H1[Price Bracket Slider]
    
    D --> I[Region Filter - All Lists]
    I --> I1[World / Continent / Country]
    
    D --> J[Results Table]
    J --> J1[Rank Column]
    J --> J2[Sortable by: Rating/CA/PA/Age/Value]
    J --> J3[Quick Search Box]
    
    J --> K[Actions]
    K --> K1[Multi-Select Players]
    K --> K2[Add Selected to Shortlist]
    K --> K3[Compare Selected]
    K --> K4[Export List]
    
    D --> L[Share Options]
    L --> L1[Generate Shareable Link]
    L --> L2[Export to Social Media Format]
```

---

### Flow 14: Probability of Development

**Trigger:** User views development probability indicators

**Gate:** "g" Edition subscription required

```mermaid
flowchart TD
    A[View Player Profile/Search Results] --> B{g Edition Active?}
    
    B -->|No| C[Show PA Only - No Probability]
    
    B -->|Yes| D[Show Full Development Metrics]
    
    D --> E[Development Probability Bar]
    E --> E1[Percentage: 0-100%]
    E --> E2[Color: Green/Orange/Red]
    E --> E3[Tooltip: Factors Affecting Probability]
    
    D --> F[Progress Rate Gauge]
    F --> F1[Speedometer Visual]
    F --> F2[Labels: Slow / Normal / Fast]
    F --> F3[Contributing Factors Listed]
    
    F3 --> G[Factor Breakdown]
    G --> G1[Ambition: High = Faster]
    G --> G2[Professionalism: High = Faster]
    G --> G3[Determination: High = Faster]
    G --> G4[Club Facilities: Better = Faster]
    G --> G5[Playing Time: More = Faster]
    
    D --> H[In Search Results]
    H --> H1[Optional Column: Dev Probability]
    H --> H2[Optional Column: Progress Rate]
    H --> H3[Sort by These Columns]
    
    D --> I[Filter Integration]
    I --> I1[Filter: Min Development Probability]
    I --> I2[Filter: Progress Rate = Fast Only]
```

---

### Flow 15: In-Game Scout (IGS)

**Trigger:** User activates overlay while in Football Manager

**Gate:** "g" Edition subscription required

```mermaid
flowchart TD
    A[Genie Scout Settings] --> B[In-Game Scout Section]
    
    B --> C{g Edition Active?}
    
    C -->|No| D[Feature Locked Message]
    D --> D1[Upgrade to Enable IGS]
    
    C -->|Yes| E[IGS Configuration]
    
    E --> F[Activation Toggle]
    F --> F1[Enable/Disable IGS]
    
    E --> G[Hotkey Configuration]
    G --> G1[Set Trigger Key: Default 'i']
    G --> G2[Modifier Keys Option]
    
    E --> H[Overlay Settings]
    H --> H1[Position: Top/Bottom/Left/Right]
    H --> H2[Transparency Slider]
    H --> H3[Size: Compact/Normal/Expanded]
    H --> H4[Theme: Match FM Style Toggle]
    
    E --> I[Content Configuration]
    I --> I1[Show Hidden Attributes: On/Off]
    I --> I2[Show CA/PA: On/Off]
    I --> I3[Show Custom Rating: On/Off]
    I --> I4[Show Development Probability: On/Off]
    
    E --> J[Preview Button]
    J --> K[Show Sample Overlay]
    K --> K1[Demonstrates All Enabled Info]
    K --> K2[Close Preview Button]
    
    F1 -->|Enabled| L[IGS Active in Background]
    L --> M[User in Football Manager]
    M --> N[User Presses Hotkey on Player]
    N --> O[Overlay Appears with Enhanced Data]
    
    O --> P[Overlay Content]
    P --> P1[Hidden Attributes Revealed]
    P --> P2[CA/PA Values]
    P --> P3[Custom Rating Score]
    P --> P4[Development Metrics]
    
    O --> Q[User Closes Overlay]
    Q --> Q1[Press Hotkey Again]
    Q --> Q2[Click Outside Overlay]
```

---

## Error States & Edge Cases

### Error State Definitions

| Error Code | Trigger | User Message | Recovery Action |
|------------|---------|--------------|-----------------|
| `E001` | FM process not found | "Football Manager is not running. Please launch FM and load a save." | Retry detection or manual file pick |
| `E002` | Invalid save file | "This file doesn't appear to be a valid FM save." | Select different file |
| `E003` | Save version mismatch | "This save is from FM[X]. Genie Scout supports FM[Y-Z]." | Update GS or use compatible save |
| `E004` | Parse timeout | "Loading is taking longer than expected. Large databases may need a moment." | Wait or cancel |
| `E005` | Memory limit | "Database too large for available memory." | Suggest closing other apps |
| `E006` | Network error (g Edition) | "Cannot connect to GS STATS. Check your internet connection." | Retry or work offline |
| `E007` | Subscription expired | "Your g Edition subscription has expired." | Renew or continue with basic |
| `E008` | Graphics not found | "Face/kit packs not found in FM graphics folder." | Configure path or use placeholders |
| `E009` | Export failed | "Could not save file to selected location." | Choose different location |
| `E010` | Filter timeout | "Filter query timed out. Try narrowing your search." | Adjust filters |

### Edge Case Handling

```mermaid
flowchart TD
    A[Filter Returns 0 Results] --> B[Show Friendly Empty State]
    B --> B1[Suggest Relaxing Filters]
    B --> B2[Show Similar Successful Queries]
    B --> B3[One-Click Reset Option]
    
    C[Filter Returns 100k+ Results] --> D[Show Performance Warning]
    D --> D1[Render First 1000 with Note]
    D --> D2[Suggest Adding Filters]
    D --> D3[Option to Export Full Set]
    
    E[Player Has No Portrait] --> F[Show Silhouette Placeholder]
    F --> F1[Position-Based Silhouette]
    F --> F2[Club Colors Applied]
    
    G[GS STATS No Data] --> H[Show Explanation]
    H --> H1[Player Too Obscure]
    H --> H2[Insufficient Community Data]
    H --> H3[Invite User to Contribute]
    
    I[Auto-Sync Conflict] --> J[Show Conflict Resolution Dialog]
    J --> J1[Keep Local Version]
    J --> J2[Use FM Version]
    J --> J3[Merge Both]
```

---

## State Management Considerations

### Global Application State

```typescript
interface AppState {
  // Core
  isLoading: boolean;
  loadProgress: number;
  loadStatus: string;
  error: AppError | null;
  
  // Database
  database: {
    loaded: boolean;
    playerCount: number;
    staffCount: number;
    clubCount: number;
    fmVersion: string;
    lastLoaded: Date;
  };
  
  // User Preferences
  preferences: {
    theme: 'light' | 'dark';
    savedDirectories: {
      fmInstall: string;
      fmSaves: string;
      fmGraphics: string;
      exports: string;
    };
    autoSync: boolean;
    defaultColumns: ColumnConfig;
    favoriteFilters: SavedFilter[];
  };
  
  // Session
  session: {
    activeShortlist: Shortlist | null;
    recentSearches: FilterConfig[];
    comparisonPlayers: Player[];
    historyStack: NavigationState[];
  };
  
  // Subscription
  subscription: {
    isGEdition: boolean;
    expiryDate: Date | null;
    features: GEditionFeature[];
  };
}
```

### Virtualization Strategy for 250k+ Records

```typescript
interface VirtualizationConfig {
  // Window settings
  itemHeight: 48; // pixels
  overscan: 10; // extra items rendered above/below viewport
  
  // Chunking
  chunkSize: 1000; // items per chunk
  maxRendered: 100; // max items in DOM at once
  
  // Indexing
  indexes: {
    byPosition: Map<Position, number[]>;
    byNationality: Map<string, number[]>;
    byClub: Map<string, number[]>;
    byAbilityRange: Map<string, number[]>;
  };
  
  // Caching
  cache: {
    recentFilters: LRUCache<string, number[]>;
    maxCacheSize: 50; // cached filter results
  };
}
```

---

## Next Steps

1. **Component Specification Document** - Detailed component breakdown with props, state, and styling
2. **Wireframes** - Visual mockups for key screens
3. **Technical Architecture** - Tauri + React implementation details
4. **API Contracts** - Data structures and IPC communication

---

*Document Version: 1.0 | Last Updated: December 2025*
